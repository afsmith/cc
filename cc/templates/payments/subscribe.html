{% extends "payments/base.html" %}
{% load url from future %}

{% block title %}Purchase a Subscription{% endblock title %}

{% block content %}
    {% with request.user.customer.current_subscription as subscription %}
        {% if not subscription or subscription.status != 'active'  %}
          {% include "payments/_subscription_status.html" %}
           {% include "payments/_subscribe_form.html" %}
        {% else %}
            <h2>Subscription Management</h2>
           
            <p class="lead">If you like, you can view your:</p> 

  <!-- Nav tabs -->
<ul class="nav nav-tabs">
  <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
  <li><a href="#payment_history" data-toggle="tab">Payment history</a></li>
  <li><a href="#change_card" data-toggle="tab">Change your card</a></li>
  <li><a href="#change_subscription" data-toggle="tab">Change your subscription</a></li>
  <li><a href="#cancel_subscription" data-toggle="tab">Cancel your subscription</a></li>
</ul>

<!-- Tab panes -->
<div class="tab-content">
  <div class="tab-pane active" id="home"> <p class="lead">You currently already have an active subscription, which will automatically renew in <strong>{{ subscription.current_period_end|timeuntil }}</strong>. </div>

  <div class="tab-pane" id="payment_history">{% include "payments/history.html" %}</div>
  <div class="tab-pane" id="change_card">{% include "payments/_change_card_form.html" %}</div>
  <div class="tab-pane" id="change_subscription">{% include "payments/_change_plan_form.html" %}</div>
  <div class="tab-pane" id="cancel_subscription">{% include "payments/_cancel_form.html" %}</div>
</div>


<!--
             <a href="{% url 'payments_history' %}">payment history</a>
             <a href="{% url 'payments_change_card' %}">change your card</a>
             <a href="{% url 'payments_change_plan' %}">change your subscription</a>
             <a href="{% url 'payments_cancel' %}">cancel your subscription</a></p>

-->
        {% endif %}
    {% endwith %}




{% endblock %}

