{% load url from future %}

<div class="cancel-subscription">
    <h2>Cancel Subscription</h2>
    {% include "payments/_subscription_status.html" %}
    <p class="lead">Are you sure that you want to cancel?</p>
<!-- below is not workign, not sure why 
    {% if request.user.customer.current_subscription.status == 'canceled' %}
        <div class="alert alert-danger">Your account has been canceled. It will remain active until <strong>{{ request.user.customer.current_subscription.current_period_end }}.</strong></div>
    {% else %} -->

    {% if error %}
        <div class="alert alert-danger">{{ error }}</div>
    {% endif %}
    <form class="form ajax" data-replace-closest=".cancel-subscription" action="{% url 'payments_ajax_cancel' %}" method="POST">
        {% csrf_token %}
    
    <button type="submit" class="btn btn-primary btn-danger"  id="form-submit" data-loading-text="Processing...">Cancel</button>
       
    </form>

    {% endif %}
</div>

<script>
  $('#form-submit').click(function () {
    var btn = $(this)
    btn.button('Cancel')

  });
</script>
